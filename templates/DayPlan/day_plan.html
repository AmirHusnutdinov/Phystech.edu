{% extends "Base.html" %}
{% block content %}
<body>
<div class="body_day_plan">
    <link rel="stylesheet" href="static/assets/css/style_day_plan.css">
    <div class="container_today">
        <div class="date-block">
            <p id="current-date"></p>
        </div>

        <div class="indicators">
            <div class="indicator">
                <label for="protein">Белки</label>
                <div class="progress-bar">
                    <div id="protein-bar" class="bar" style="width: 0%;"></div>
                </div>
                <input type="number" id="protein" placeholder="г" oninput="updateProgressBar('protein-bar', this.value)">
            </div>
            <div class="indicator">
                <label for="fats">Жиры</label>
                <div class="progress-bar">
                    <div id="fats-bar" class="bar" style="width: 0%;"></div>
                </div>
                <input type="number" id="fats" placeholder="г" oninput="updateProgressBar('fats-bar', this.value)">
            </div>
            <div class="indicator">
                <label for="carbs">Углеводы</label>
                <div class="progress-bar">
                    <div id="carbs-bar" class="bar" style="width: 0%;"></div>
                </div>
                <input type="number" id="carbs" placeholder="г" oninput="updateProgressBar('carbs-bar', this.value)">
            </div>
            <div class="indicator">
                <label for="calories">Калории</label>
                <div class="progress-bar">
                    <div id="calories-bar" class="bar" style="width: 0%;"></div>
                </div>
                <input type="number" id="calories" placeholder="ккал" oninput="updateProgressBar('calories-bar', this.value)">
            </div>
        </div>

        <div class="links-container">
            <button id="add-link">Добавить прием пищи</button>
            <div id="links-list"></div>
        </div>
    </div>

    <script>
        // Обновление даты
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('ru-RU', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

        // Обновление progress bar
        function updateProgressBar(barId, value) {
            const bar = document.getElementById(barId);
            const percentage = Math.min(value, 100); // Ограничиваем значение до 100%
            bar.style.width = percentage + '%';
        }

        // Счетчик для приема пищи
        let mealCounter = 1;

        // Добавление и удаление полей
        document.getElementById('add-link').addEventListener('click', function() {
            const linkList = document.getElementById('links-list');
            const newLink = document.createElement('div');
            newLink.className = 'link-item';
            newLink.innerHTML = `
                <a href="#" class="link-square">${mealCounter}-й прием пищи</a>
                <button class="remove-link">Удалить</button>
            `;
            linkList.appendChild(newLink);

            // Добавляем анимацию
            newLink.classList.add('animate-in');

            // Удаление поля
            newLink.querySelector('.remove-link').addEventListener('click', function() {
                linkList.removeChild(newLink);
                mealCounter--; // Уменьшаем счетчик при удалении
                updateMealNumbers(); // Обновляем номера приемов пищи
            });

            mealCounter++; // Увеличиваем счетчик при добавлении
        });

        // Обновление номеров приемов пищи
        function updateMealNumbers() {
            const linkItems = document.querySelectorAll('.link-item');
            linkItems.forEach((item, index) => {
                item.querySelector('.link-square').innerText = `${index + 1}-й прием пищи`;
            });
        }
    </script>
    </div>
</body>
{% endblock %}